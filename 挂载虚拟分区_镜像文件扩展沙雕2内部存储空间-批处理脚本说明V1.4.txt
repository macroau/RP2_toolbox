1. 本bat脚本会将/data/media和/data/data目录分别挂载到SD卡上一个32G和一个8G的镜像文件

2. 32G和8G的镜像文件的文件名分别为image_data_media.img和image_data_data.img

3. 镜像文件会自动生成，位置在外置卡的根目录，如果SD卡上有同名文件，将会被覆盖

4. 本脚本不会让内部存储空间变大，只是会将/data/media和/data/data目录的内容转移到SD卡中的虚拟镜像中

5. 本脚本只可用于已经成功刷了沙雕2官方的9月15日更新系统的机子

6. 需要用足够快的SD卡，推荐U1以上速度的卡。个人主观感觉，挂载/data/media和/data/data目录到SD卡虚拟镜像后，对机器性能有些影响。理论上越快的卡，影响越小。

7. 除了生成两个巨大的镜像文件之外，本脚本不会修改SD卡内容，也不影响SD卡分区

8. 本脚本不需要SuperSU等全局root， 只要adb root即可（需要能够正常使用ADB工具）

9. 本脚本某些步骤比较耗时，请耐心等待

10. 生成的两个镜像文件的预设大小可以调整，熟悉批处理脚本的可以自行修改

11. 脚本运行到后面会提示是否删除原机/data/media和/data/data目录的内容，我个人是已经删了的，可以最大的释放内部存储空间。使用者可自行评估风险。

12. 本人水平有限，脚本以及所涉及的方法可能有bug，使用本脚本需要使用者自己承担风险。

# 关于恢复

1. 可以恢复之前的挂载状态，即把 /data/media 或 /data/data 或 /data/app 等挂载点的挂载目标恢复到真实的内部存储

2. 恢复挂载状态之前，请先用“检查数据占用空间情况.bat”检查各个挂载点的数据占用情况，该批处理会检查 /data/media， /data/data 和 /data/app 的数据占用情况，你可能没有挂载所有目录到镜像文件，所以请只关注你挂载了的那个挂载点目录，要确保他们的数据占用，小于内置存储的剩余空间。 如果各个挂载点目录的数据大小大于内置存储的剩余空间大小，就需要想办法删除各个挂载点目录尽可能多的数据，可以删除app，也可以直接用机器上的mix文件管理（可能需要root），或者用adb shell，直到各个挂载点目录的数据大小小于内置存储的剩余空间大小。

3. 在确保各个挂载点目录的数据大小 小于 内置存储的剩余空间大小后，可以拉取boot.sh文件
adb pull /system/bin/boot.sh

然后手工移除boot.sh中的镜像文件相关挂载命令，并执行
adb root
adb remount 
adb push boot.sh /system/bin/boot.sh
adb reboot

重启后，挂载就已经取消了。

4. 重启后，即已经取消了挂载，此时需要将数据从镜像文件中迁移（恢复）到内部存储，你只需要运行那个名字中带有数据迁移的脚本，运行后一开始会有挂载点以及相应文件的选择，千万不要弄错。


更新记录
V1.1  增加了备份boot.sh的步骤
V1.2  增加了挂载到/data/app的脚本
V1.3  增加了取消挂载后迁移数据的脚本
V1.4  优化了取消挂载后迁移数据的脚本

#EOF